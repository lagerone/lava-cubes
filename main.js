!function(t){var e={};function s(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},s.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=1)}([function(t,e,s){var i,n;!function(o){function a(t){if(r=L(a),!(t<l+g)){for(c+=t-l,l=t,b(t,c),t>m+v&&(d=u*f*1e3/(t-m)+(1-u)*d,m=t,f=0),f++,y=0;c>=h;)if(S(h),c-=h,++y>=240){x=!0;break}I(c/h),k(d,x),x=!1}}var r,h=1e3/60,c=0,l=0,d=60,u=.9,v=1e3,m=0,f=0,y=0,g=0,w=!1,p=!1,x=!1,_="object"==typeof window?window:o,L=_.requestAnimationFrame||function(){var t,e,s=Date.now();return function(i){return t=Date.now(),e=Math.max(0,h-(t-s)),s=t+e,setTimeout(function(){i(t+e)},e)}}(),D=_.cancelAnimationFrame||clearTimeout,E=function(){},b=E,S=E,I=E,k=E;o.MainLoop={getSimulationTimestep:function(){return h},setSimulationTimestep:function(t){return h=t,this},getFPS:function(){return d},getMaxAllowedFPS:function(){return 1e3/g},setMaxAllowedFPS:function(t){return void 0===t&&(t=1/0),0===t?this.stop():g=1e3/t,this},resetFrameDelta:function(){var t=c;return c=0,t},setBegin:function(t){return b=t||b,this},setUpdate:function(t){return S=t||S,this},setDraw:function(t){return I=t||I,this},setEnd:function(t){return k=t||k,this},start:function(){return p||(p=!0,r=L(function(t){I(1),w=!0,l=t,m=t,f=0,r=L(a)})),this},stop:function(){return w=!1,p=!1,D(r),this},isRunning:function(){return w}},i=o.MainLoop,void 0===(n="function"==typeof i?i.call(e,s,e,t):i)||(t.exports=n)}(this)},function(t,e,s){"use strict";s.r(e);var i=s(0),n=s.n(i);class o{constructor(t,e,s,i,n){this.x=t,this.y=e,this.width=s,this.height=i,this.color=n}get xEnd(){return this.x+this.width}get yEnd(){return this.y+this.height}}class a extends o{constructor(t,e,s,i,n,o,a){super(t,e,s,i,"#2ECC40"),this.canvasWidth=n,this.canvasHeight=o,this.movement=a,this.moveIsValid=!1}moveUp(){if(this.y>0)return this.y-=this.movement,void(this.moveIsValid=!0);this.moveIsValid=!1}moveDown(){if(this.y<this.canvasHeight-this.height)return this.y+=this.movement,void(this.moveIsValid=!0);this.moveIsValid=!1}moveRight(){if(this.x<this.canvasWidth-this.width)return this.x+=this.movement,void(this.moveIsValid=!0);this.moveIsValid=!1}moveLeft(){if(this.x>0)return this.x-=this.movement,void(this.moveIsValid=!0);this.moveIsValid=!1}}class r extends o{constructor({startX:t,startY:e,width:s,height:i,canvasWidth:n,canvasHeight:o,movement:a}){super(t,e,s,i,"#FF4136"),this.canvasWidth=n,this.canvasHeight=o,this.movement=a,this.isStatic=!1,this.maxY=o-i}moveDown(){this.isStatic||(this.y<this.maxY?this.y+=this.movement:this.isStatic=!0)}}const h=2,c=300,l=300,d=30,u=30;class v{constructor(t,e,s,i){this.canvas=t,this.scoreElement=e,this.gameControl=s,this.canvas.width=c,this.canvas.height=l,this.ctx=t.getContext("2d"),this.hero=new a(100,100,d,u,c,l,h),this.level=1,this.lavaThreshold=150,this.simultaniousLavasAboveThreshold=3,this.lavaSpeedMin=.5,this.lavaSpeedMax=1.5,this.score=0,this.gameOver=i,this.foods=this.generateFoods(8),this.lavas=this.generateLavas(this.simultaniousLavasAboveThreshold),this.onUpdate=this.onUpdate.bind(this),this.draw=this.draw.bind(this),this.recalculate=this.recalculate.bind(this)}addScore(){this.score+=1,this.scoreElement.innerText=this.score}entitiesAreColliding(t,e){return i=e,((s=t).xEnd>i.x&&s.x<i.x||s.x<i.xEnd&&s.xEnd>i.xEnd)&&function(t,e){return t.yEnd>e.y&&t.y<e.y||t.y<e.yEnd&&t.yEnd>e.yEnd}(t,e);var s,i}levelUp(){this.lavaThreshold=this.lavaThreshold-5,this.lavaSpeedMin=1.1*this.lavaSpeedMin,this.lavaSpeedMax=1.1*this.lavaSpeedMax,this.foods=this.generateFoods(8),this.lavas=this.generateLavas(this.simultaniousLavasAboveThreshold),this.level+=1,this.level%5==0&&(this.simultaniousLavasAboveThreshold+=1),document.getElementById("level").innerText=`Level ${this.level}`}onUpdate(){this.foods.length?(this.gameControl.isUp()&&this.hero.moveUp(),this.gameControl.isDown()&&this.hero.moveDown(),this.gameControl.isRight()&&this.hero.moveRight(),this.gameControl.isLeft()&&this.hero.moveLeft(),this.hero.moveIsValid&&this.foods.forEach(t=>{this.entitiesAreColliding(this.hero,t)&&(this.foods=this.foods.filter(e=>e!==t),this.addScore())}),this.lavas.forEach(t=>{t.isStatic||t.moveDown(),this.entitiesAreColliding(this.hero,t)&&this.gameOver()})):this.levelUp()}recalculate(){const t=this.lavas.filter(t=>!t.isStatic&&t.y<150).length;if(t<this.simultaniousLavasAboveThreshold){const e=this.generateLavas(this.simultaniousLavasAboveThreshold-t);this.lavas=[...this.lavas,...e]}}generateFoods(t){const e=[];for(let s=0;s<t;s++)e.push(new o(m(50,l-50),m(50,c-50),15,15,"#0074D9"));return e}generateLavas(t){const e=[];for(let n=0;n<t;n++)e.push(new r({startX:m(0,c-10),startY:0,width:10,height:10,canvasWidth:c,canvasHeight:l,movement:(s=.5,i=1.5,Math.random()*(i-s)+s)}));var s,i;return e}draw(t){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),[...this.foods,this.hero,...this.lavas].forEach(t=>this.drawEntity(t))}drawEntity(t){this.ctx.fillStyle=t.color,this.ctx.fillRect(t.x,t.y,t.width,t.height)}}function m(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t))+t}const f=37,y=39,g=40,w=38;let p={};let x,_,L=!0;const D=new class{constructor(){this.keyIsDown=!1,this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this)}reset(){p={}}onKeyDown({keyCode:t}){p[t]=t,this.keyIsDown=!0}onKeyUp({keyCode:t}){delete p[t],this.keyIsDown=!1}isUp(){return this.keyIsDown&&p[w]}isDown(){return this.keyIsDown&&p[g]}isRight(){return this.keyIsDown&&p[y]}isLeft(){return this.keyIsDown&&p[f]}};window.addEventListener("keydown",t=>{D.onKeyDown(t),L&&32===t.keyCode&&(x=b())}),window.addEventListener("keyup",t=>{D.onKeyUp(t)});const E=document.querySelector(".control");function b(){L=!1,document.querySelector(".game-over").classList.remove("canvas-overlay--show"),document.querySelector(".start-game").classList.remove("canvas-overlay--show"),D.reset(),document.getElementById("level").innerText="Level 1",document.getElementById("score").innerText=0;const t=new v(document.getElementById("game-canvas"),document.getElementById("score"),D,S);return _=setInterval(()=>{t.recalculate()},200),n.a.setUpdate(t.onUpdate).setDraw(t.draw).start()}function S(t){x.stop(),clearInterval(_),document.querySelector(".game-over").classList.add("canvas-overlay--show"),L=!0}E.addEventListener("touchstart",t=>{const{target:e}=t;t.preventDefault(),e.classList.contains("control__button__up")&&D.onKeyDown({keyCode:w}),e.classList.contains("control__button__down")&&D.onKeyDown({keyCode:g}),e.classList.contains("control__button__right")&&D.onKeyDown({keyCode:y}),e.classList.contains("control__button__left")&&D.onKeyDown({keyCode:f})}),E.addEventListener("touchend",t=>{const{target:e}=t;t.preventDefault(),e.classList.contains("control__button__up")&&D.onKeyUp({keyCode:w}),e.classList.contains("control__button__down")&&D.onKeyUp({keyCode:g}),e.classList.contains("control__button__right")&&D.onKeyUp({keyCode:y}),e.classList.contains("control__button__left")&&D.onKeyUp({keyCode:f})}),document.querySelector(".game-over").addEventListener("click",t=>{t.preventDefault(),L&&(x=b())}),document.querySelector(".start-game").addEventListener("click",t=>{t.preventDefault(),L&&(x=b())})}]);